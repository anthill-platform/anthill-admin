{% extends "header.html" %}

{% block headers %}
<link rel="stylesheet" href="/static/css/bootstrap-tagsinput.css">
<link rel="stylesheet" href="/static/css/bootstrap-select.min.css">
<link href="/static/css/jsoneditor.min.css" rel="stylesheet" type="text/css">
<link href="/static/css/bootstrap-datetimepicker.min.css" rel="stylesheet" type="text/css">
<link href="/static/css/bootstrap-switch.min.css" rel="stylesheet" type="text/css">
<link href="/static/css/prism.css" rel="stylesheet" type="text/css">
<link href="/static/css/codeflask.css" rel="stylesheet" type="text/css">
<link href="/static/css/codemirror.css" rel="stylesheet" type="text/css">
<link href="/static/css/themes/idle.css" rel="stylesheet" type="text/css">
<link href="/static/css/show-hint.css" rel="stylesheet" type="text/css">

<script src="/static/js/service.js"></script>
<script src="/static/js/validator.min.js"></script>
<script src="/static/js/moment.min.js"></script>
<script src="/static/js/bootstrap-tagsinput.min.js"></script>
<script src="/static/js/bootstrap-select.min.js"></script>
<script src="/static/js/bootstrap-datetimepicker.min.js"></script>
<script src="/static/js/bootstrap-switch.min.js"></script>
<script src="/static/js/wsrpc.js"></script>
<script src="/static/js/renderjson.js"></script>
<script src="/static/js/prism.js"></script>
<script src="/static/js/codeflask.js"></script>
<script src="/static/js/codemirror.js"></script>
<script src="/static/js/mode/javascript.js"></script>
<script src="/static/js/hint/show-hint.js"></script>
<script src="/static/js/SimpleAjaxUploader.min.js"></script>

<script src="/static/js/jsoneditor.min.js"></script>
<script type="text/javascript">var JsonEditor = JSONEditor</script>
<script src="/static/js/dorneditor.js"></script>
<script type="text/javascript">var DornEditor = JSONEditor</script>
{% end %}

{% block navbar_left %}
    {% for i, (_service_id, service) in enumerate(services_list.iteritems()) %}
        {% set location = service["location"] %}
        {% set service_metadata = service["metadata"] or {} %}

        {% set title = service_metadata.get("title", _service_id) %}
        {% set description = service_metadata.get("description", "") %}
        {% set icon = service_metadata.get("icon") %}

        <li
        {% if _service_id == service_id %}
        class="active"
        {% end %} title="{{ description }}">
            <a href="/service/{{ _service_id }}/index">{{ title }}
                <span style="font-size:16px;" class="pull-right hidden-xs showopacity">
                    {% if icon %}
                        <i class="fa fa-{{ icon }}" aria-hidden="true"></i>
                    {% end %}
                </span>
            </a>
        </li>
    {% end %}
    <li>
        <a href="/debug" target="_blank"> Developer Console
            <span style="font-size:16px;" class="pull-right hidden-xs showopacity">
                <i class="fa fa-terminal" aria-hidden="true"></i></span></a>
    </li>
{% end %}

{% block navbar %}

{% import json %}
{% import urllib %}

<ul id="service-breadcrumbs" class="breadcrumb list-inline">
    {% set metadata_ = services_list.get(service_id, {}).get("metadata", {}) %}
    <li><a href="/service/{{ service_id }}/index">
        <i class="fa fa-{{ metadata_.get('icon', 'wrench') }}" aria-hidden="true"></i>
        {{ metadata_.get("title", service_id) }}</a>
    </li>
</ul>

{% end %}

{% block title %}
    {% set metadata_ = services_list.get(service_id, {}).get("metadata", {}) %}
    {{ metadata_.get("title", service_id) }}
{% end %}

{% block root %}

{% import json %}

<script type="text/javascript">
    $(function()
    {
        var service_id = "{{ service_id }}";
        var data = {% raw json.dumps(data, ensure_ascii=False) %};
        var context = {% raw json.dumps(context) %};
        var action = "{{ action }}";

       init_service(service_id, action, data, context);
    });
</script>

{% if notice %}
    <script type="text/javascript">
        $(function()
        {
            var notice = {% raw json.dumps(notice) %};

            switch (notice["kind"])
            {
                case "info":
                {
                    notify_success(notice["message"]);

                    break;
                }
                case "error":
                {
                    notify_error(notice["message"]);

                    break;
                }
            }
        });
    </script>
{% end %}

<div id="root" class="container-fluid">
</div>

{% end %}